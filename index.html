<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flashcard App</title>
    <style>
    /* ... (keep the existing styles) ... */
    .options {
        text-align: left;
        margin-top: 10px;
    }
    .answer {
        margin-top: 10px;
        font-weight: bold;
    }
    </style>
</head>
<body>
    <div class="container">
    <h1>Flashcard App</h1>
    <div id="flashcard-sets">
    <select id="set-selector">
    <option value="">Select a flashcard set</option>
    </select>
    </div>
    <button id="load-flashcards">Load Flashcards</button>
    <div id="flashcard">Select a flashcard set and click 'Load Flashcards' to start</div>
    <div id="controls">
    <button id="prev">Previous</button>
    <button id="flip">Flip</button>
    <button id="next">Next</button>
    </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/2.0.3/marked.min.js"></script>
    <script>
    const setSelector = document.getElementById('set-selector');
    const loadButton = document.getElementById('load-flashcards');
    const flashcard = document.getElementById('flashcard');
    const prevButton = document.getElementById('prev');
    const flipButton = document.getElementById('flip');
    const nextButton = document.getElementById('next');

    let flashcards = [];
    let currentIndex = 0;
    let showingQuestion = true;

    document.addEventListener('DOMContentLoaded', loadFlashcardSets);
    loadButton.addEventListener('click', loadSelectedFlashcards);

    async function loadFlashcardSets() {
    try {
    const response = await fetch('https://api.github.com/repos/pratapkafle/FlashcardApp/contents/flashcards');
    if (!response.ok) {
    throw new Error('Failed to load flashcard sets');
    }
    const files = await response.json();
    const mdFiles = files.filter(file => file.name.endsWith('.md'));
    populateSetSelector(mdFiles);
    } catch (error) {
    console.error('Error loading flashcard sets:', error);
    setSelector.innerHTML = '<option value="">Error loading flashcard sets</option>';
    }
    }

    function populateSetSelector(files) {
    setSelector.innerHTML = '<option value="">Select a flashcard set</option>';
    files.forEach(file => {
    const option = document.createElement('option');
    option.value = file.name;
    option.textContent = file.name.replace('.md', '').replace(/_/g, ' ');
    setSelector.appendChild(option);
    });
    }

    async function loadSelectedFlashcards() {
    const selectedSet = setSelector.value;
    if (!selectedSet) {
    flashcard.textContent = 'Please select a flashcard set';
    return;
    }

    try {
    const response = await fetch(`flashcards/${selectedSet}?_=${new Date().getTime()}`);
    if (!response.ok) {
    throw new Error('Failed to load flashcards');
    }
    const content = await response.text();
    parseMarkdown(content);
    showCard();
    loadButton.textContent = 'Refresh Flashcards';
    } catch (error) {
    console.error('Error loading flashcards:', error);
    flashcard.textContent = 'Error loading flashcards. Please try again.';
    }
    }

    function parseMarkdown(content) {
    const lines = content.split('\n');
    flashcards = [];
    let currentQuestion = '';
    let currentOptions = [];
    let currentAnswer = '';

    for (const line of lines) {
        if (line.trim() && !line.match(/^[a-e]\./)) {
            if (currentQuestion) {
                flashcards.push({ question: currentQuestion, options: currentOptions, answer: currentAnswer });
                currentOptions = [];
                currentAnswer = '';
            }
            currentQuestion = line.trim();
        } else if (line.match(/^[a-e]\./)) {
            currentOptions.push(line.trim());
        } else if (line.trim() === 'Answer') {
            // Next line will be the answer
        } else if (currentOptions.length > 0 && line.trim()) {
            currentAnswer = line.trim();
        }
    }

    if (currentQuestion) {
        flashcards.push({ question: currentQuestion, options: currentOptions, answer: currentAnswer });
    }

    currentIndex = 0;
    showingQuestion = true;
    }

    function showCard() {
    if (flashcards.length === 0) {
    flashcard.textContent = 'No flashcards available';
    return;
    }

    const card = flashcards[currentIndex];
    let content = `<h2>${card.question}</h2>`;
    if (showingQuestion) {
        content += '<div class="options">';
        card.options.forEach(option => {
            content += `<p>${option}</p>`;
        });
        content += '</div>';
    } else {
        content += `<div class="answer">Answer: ${card.answer}</div>`;
    }
    flashcard.innerHTML = content;
    }

    flashcard.addEventListener('click', () => {
    showingQuestion = !showingQuestion;
    showCard();
    });

    prevButton.addEventListener('click', () => {
    if (currentIndex > 0) {
    currentIndex--;
    showingQuestion = true;
    showCard();
    }
    });

    nextButton.addEventListener('click', () => {
    if (currentIndex < flashcards.length - 1) {
    currentIndex++;
    showingQuestion = true;
    showCard();
    }
    });

    flipButton.addEventListener('click', () => {
    showingQuestion = !showingQuestion;
    showCard();
    });
    </script>
</body>
</html>